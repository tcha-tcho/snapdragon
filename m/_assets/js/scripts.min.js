//$( 'h1' ).balanceText();

/*var s = skrollr.init( {
    beforerender: function( data ) {
        console.log( data.curTop );
    }
} );*/

/*$( document ).on( 'touchstart', function() {
    document.getElementById( 'introMovie' ).play();
} );*/

var flag = true;

var curItem = 0;
var difOffsetX = 0;

/*if ('addEventListener' in document) {
    document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body);
    }, false);
}*/

var navDif = $( '#nav-diferencas ul' );
navDif.owlCarousel({
    responsive: {
        0: {
            items: 3
        },
        480: {
            items: 4
        },
        600: {
            items: 5
        },
        720: {
            items: 7
        }
    }
} );

var dif = $( '#diferencas' );
dif.owlCarousel({
    items: 1,
    center: true,
    //mouseDrag: false,
    //touchDrag: false,
    responsive: {
        0: {
            autoHeight: true
        },
        720: {
            autoHeight: false
        }
    }
} );

dif.on( 'drag.owl.carousel', function( event ) {
    //console.log( 't: ' + event.item.index );
    flag = false;
} );

dif.on( 'changed.owl.carousel', function( event ) {
    //console.log ( event );
    //console.log( event.target.id );
    //console.log( event.relatedTarget.drag );
    //console.log( 'c: ' + event.item.index );
    //console.log( event.relatedTarget.drag.startX );
    //console.log( event.relatedTarget.drag.updatedX );
    
    if ( event.target.id == 'diferencas' && !flag ) {
        /*if ( event.relatedTarget.drag.offsetX - event.relatedTarget.drag.currentX < 30 ) {
            console.log( 'right' );

            if ( event.item.index > 0 && event.item.index < 6 )
                $( '#nav-diferencas li.active' ).removeClass( 'active' );

            if ( event.item.index == 6 )
                $( '#nav-diferencas li.active' ).removeClass( 'active' );


            navDif.trigger( 'prev.owl.carousel' );
            $( '#nav-diferencas .owl-item:nth-child( '+ ( event.item.index ) + ') li' ).addClass( 'active' );
        } else if ( event.relatedTarget.drag.offsetX - event.relatedTarget.drag.currentX > 30 ) {
            console.log( 'left' );

            if ( event.item.index > 0 && event.item.index < 6 )
                $( '#nav-diferencas li.active' ).removeClass( 'active' );

            if ( event.item.index == 0 )
                $( '#nav-diferencas li.active' ).removeClass( 'active' );

            navDif.trigger( 'next.owl.carousel' );
            $( '#nav-diferencas .owl-item:nth-child( '+ ( event.item.index + 2 ) + ') li' ).addClass( 'active' );
        }*/
        
        $( '#nav-diferencas li.active' ).removeClass( 'active' );
        
        if ( event.relatedTarget.drag.offsetX < event.relatedTarget.drag.currentX ) {
            //console.log( 'right' );

            navDif.trigger( 'prev.owl.carousel' );
            $( '#nav-diferencas .owl-item:nth-child( '+ ( event.item.index + 1) + ') li' ).addClass( 'active' );
        } else {
            //console.log( 'left' );

            navDif.trigger( 'next.owl.carousel' );
            $( '#nav-diferencas .owl-item:nth-child( '+ ( event.item.index + 1 ) + ') li' ).addClass( 'active' );
        }
    }
    
    flag = false;
    
    if ( event.target.id == 'diferencas' ) {
        //console.log( event.item.index );
        curItem = event.item.index;
        
        analyticsCompare();
    }
} );

function analyticsCompare() {
    switch ( curItem ) {
        case 0:
            console.log( 'conectividade' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'conectividade', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'conectividade', 'outras marcas']);

            break;
        case 1:
            console.log( 'games' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'games', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'games', 'outras marcas']);

            break;
        case 2:
            console.log( 'apps' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'apps', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'apps', 'outras marcas']);

            break;
        case 3:
            console.log( 'video' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'video', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'video', 'outras marcas']);

            break;
        case 4:
            console.log( 'fotos' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'fotos', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'fotos', 'outras marcas']);

            break;
        case 5:
            console.log( 'audio' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'audio', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'audio', 'outras marcas']);

            break;
        case 6:
            console.log( 'bateria' );

            if ( $( '.snapdragon' ).is( ':visible' ) )
                //console.log( 'snapdragon' );
                _gaq.push(['_trackEvent', 'conheca', 'bateria', 'snapdragon']);
            else
                //console.log( 'outras marcas' );
                _gaq.push(['_trackEvent', 'conheca', 'bateria', 'outras marcas']);

            break;
    }
}

$( '.toggle-snapdragon a' ).on( 'click', function( event ) {
    $( '.toggle-snapdragon' ).addClass( 'active' );
    $( '.toggle-concorrente' ).removeClass( 'active' );
    $( '.snapdragon' ).show();
    $( '.concorrente' ).hide();
    
    analyticsCompare();
} );

$( '.toggle-concorrente a' ).on( 'click', function( event ) {
    $( '.toggle-snapdragon' ).removeClass( 'active' );
    $( '.toggle-concorrente' ).addClass( 'active' );
    $( '.snapdragon' ).hide();
    $( '.concorrente' ).show();
    
    analyticsCompare();
} );

$( '#nav-diferencas li' ).on( 'click', function() {
    $( '#nav-diferencas li' ).removeClass( 'active' );
    $( this ).addClass( 'active' );

    console.log( $( '#nav-diferencas li' ).index( this ) );
    dif.trigger( 'to.owl.carousel', [$( '#nav-diferencas li' ).index( this )] );
    
    flag = true;
} );

$( '#nav-diferencas li' ).on( 'click', function() {
    console.log( curItem );
    if( $( '#nav-diferencas li' ).index( this ) > curItem )
        navDif.trigger( 'next.owl.carousel' );
    else if( $( '#nav-diferencas li' ).index( this ) < curItem )
        navDif.trigger( 'prev.owl.carousel' );

    curItem = $( '#nav-diferencas li' ).index( this );
} );

var secao = [false, false, false, false, false]; // #coracao, #compare, #video, #compartilhe, #saiba-mais

$( window ).on( 'scroll', function() {
    //console.log( $( window ).scrollTop() );
    //console.log( $( '#coracao' ).offset().top );
    
    /*if ( $( window ).scrollTop() >= $( '#coracao' ).offset().top - 24 && $( window ).scrollTop() < $( '#compare' ).offset().top )
        console.log( 'seta' );
    if ( $( window ).scrollTop() >= $( '#compare' ).offset().top -24 && $( window ).scrollTop() < $( '#video' ).offset().top )
        console.log( 'conheca' );
    if ( $( window ).scrollTop() >= $( '#video' ).offset().top -24 && $( window ).scrollTop() < $( '#compartilhe' ).offset().top )
        console.log( 'video' );
    if ( $( window ).scrollTop() >= $( '#compartilhe' ).offset().top - 24 && $( window ).scrollTop() < $( '#saiba-mais' ).offset().top )
        console.log( 'compartilhe' );
    if ( $( window ).scrollTop() >= $( '#saiba-mais' ).offset().top - 24 )
        console.log( 'saiba-mais' );*/
    
    //console.log( $( window ).scrollTop() + $( window ).innerHeight() );
    
    if ( !secao[0] && $( window ).scrollTop() + $( window ).innerHeight() > $( '#coracao h1' ).offset().top + $( '#coracao h1' ).outerHeight() ) {
        //console.log( 'coracao' );
        //_gaq.push(['_trackEvent', 'home', 'seta', 'menu',0,true]);
        _gaq.push(['_trackEvent', 'troca-tela', '1', '',0,true]);
        secao[0] = true;
    }
    
    if ( !secao[1] && $( window ).scrollTop() + $( window ).innerHeight() > $( '#compare h1' ).offset().top + $( '#compare h1' ).outerHeight() ) {
        //console.log( 'compare' );
        //_gaq.push(['_trackEvent', 'menu', 'conheca', '',0,true]);
        _gaq.push(['_trackEvent', 'troca-tela', '2', '',0,true]);
        _gaq.push(['_trackEvent', 'conheca', 'conectividade', 'snapdragon']);
        secao[1] = true;
    }
    
    if ( !secao[2] && $( window ).scrollTop() + $( window ).innerHeight() > $( '#video #adMovie' ).offset().top + $( '#video #adMovie' ).outerHeight() ) {
        //console.log( 'video' );
        _gaq.push(['_trackEvent', 'troca-tela', '3', '',0,true]);
        secao[2] = true;
    }
    
    if ( !secao[3] && $( window ).scrollTop() + $( window ).innerHeight() > $( '#compartilhe h1' ).offset().top + $( '#compartilhe h1' ).outerHeight() ) {
        //console.log( 'compartilhe' );
        _gaq.push(['_trackEvent', 'troca-tela', '4', '',0,true]);
        secao[3] = true;
    }
    
    if ( !secao[4] && $( window ).scrollTop() + $( window ).innerHeight() > $( '#saiba-mais h1' ).offset().top + $( '#saiba-mais h1' ).outerHeight() ) {
        //console.log( 'saiba-mais' );
        secao[4] = true;
    }
    
    if ( $( window ).scrollTop() + $( window ).innerHeight() >= $( document ).outerHeight() - 24 ) {
        //console.log( 'final' );
        _gaq.push(['_trackEvent', 'final', 'final']);
    }
} );

 function ShareController() {
    var $this = this;
    var urlToShare = $('meta[property="og:url"]').attr("content");
    $("#share-facebook").sharrre({
        share: {
            facebook: true
        },
        enableHover: false,
        enableTracking: true,
        template: '<i class="fa fa-facebook"></i> <span class="sr-only">Facebook</span> <span class="count hidden-xs sr-only">{total}</span>',
        url: urlToShare,
        click: function(api, options) {
            api.openPopup("facebook");
            _gaq.push(['_trackEvent', 'redes sociais', 'facebook', '',0,true]);
        }
    });
    $("#share-twitter").sharrre({
        share: {
            twitter: true
        },
        enableHover: false,
        enableTracking: true,
        template: '<i class="fa fa-twitter"></i> <span class="sr-only">Twitter</span> <span class="count hidden-xs sr-only">{total}</span>',
        url: urlToShare,
        click: function(api, options) {
            api.openPopup("twitter");
            _gaq.push(['_trackEvent', 'redes sociais', 'twitter', '',0,true]);
        }
    })
}

ShareController();
